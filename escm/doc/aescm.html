<HTML>
<HEAD>
<TITLE>aescm -- preprocess embedded Scheme code in documents</TITLE>
<LINK REV="made" HREF="mailto:root@gohan11.freebsd.org">
</HEAD>

<BODY>

<A NAME="__index__"></A>
<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#name">NAME</A></LI>
	<LI><A HREF="#synopsis">SYNOPSIS</A></LI>
	<LI><A HREF="#description">DESCRIPTION</A></LI>
	<UL>

		<LI><A HREF="#options">OPTIONS</A></LI>
		<LI><A HREF="#scheme variables">SCHEME VARIABLES</A></LI>
		<LI><A HREF="#environment variables">ENVIRONMENT VARIABLES</A></LI>
		<LI><A HREF="#handler cgi program">HANDLER CGI PROGRAM</A></LI>
		<LI><A HREF="#other interpreter languages">OTHER INTERPRETER LANGUAGES</A></LI>
	</UL>

	<LI><A HREF="#caveats">CAVEATS</A></LI>
	<LI><A HREF="#changes">CHANGES</A></LI>
	<UL>

		<LI><A HREF="#syntax">Syntax</A></LI>
		<LI><A HREF="#options">Options</A></LI>
		<LI><A HREF="#file arguments">File Arguments</A></LI>
		<LI><A HREF="#metaarguments">Meta-Arguments</A></LI>
	</UL>

	<LI><A HREF="#author">AUTHOR</A></LI>
	<LI><A HREF="#see also">SEE ALSO</A></LI>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="name">NAME</A></H1>
<P>aescm -- preprocess embedded Scheme code in documents</P>
<P>
<HR>
<H1><A NAME="synopsis">SYNOPSIS</A></H1>
<P><STRONG>aescm</STRONG> <EM>[OPTION]</EM> ... <EM>FILE</EM> ...</P>
<P>
<HR>
<H1><A NAME="description">DESCRIPTION</A></H1>
<P><STRONG>Aescm</STRONG> is a filter program
to preprocess embedded Scheme code in documents.
Scheme code between <CODE>&lt;?scm</CODE> and <CODE>?&gt;</CODE> is evaluated
and replaced with what is written to
<CODE>(current-output-port)</CODE> while the evaluation.
An expression between <CODE>&lt;?scm:d</CODE> and <CODE>?&gt;</CODE> is evaluated
and replaced with its result.
The sharp-bang line and the meta-argument lines (if any)
of a script are skipped.</P>
<P>The body of <STRONG>aescm</STRONG> is a simple converter
from a text to Scheme code,
which will be evaluated by a backend Scheme interpreter.
It works with most implementations.</P>
<P>This program can be used
as a handler CGI program of Apache web servers
or as if it were an interpreter in a CGI script.
If it is the case,
a content header for HTML will be added
and error messages are to be sent to stdout.</P>
<P>
<H2><A NAME="options">OPTIONS</A></H2>
<DL>
<DT><STRONG><A NAME="item_%2DE%2C_%2D%2Dno%2Deval">-E, --no-eval</A></STRONG><BR>
<DD>
Preprocess files and convert them into a Scheme program.
<P></P>
<DT><STRONG><A NAME="item_%2DH%2C_%2D%2Dno%2Dheader">-H, --no-header</A></STRONG><BR>
<DD>
Print no content header even in a CGI script.
<P></P>
<DT><STRONG><A NAME="item_%2Dc%2C_%2D%2Dclassic">-c, --classic</A></STRONG><BR>
<DD>
Suppress the content header and send error messages to stdout.
<P></P>
<DT><STRONG><A NAME="item_%2De%2C_%2D%2Deval%3DEXPR">-e, --eval=EXPR</A></STRONG><BR>
<DD>
Evaluate an expression before processing files.
This option can be used as many times as you want.
<P></P>
<DT><STRONG><A NAME="item_%2Df%2C_%2D%2Dfooter%3DFILENAME">-f, --footer=FILENAME</A></STRONG><BR>
<DD>
Specify the footer file.
<P></P>
<DT><STRONG><A NAME="item_%2Dh%2C_%2D%2Dheader%3DFILENAME">-h, --header=FILENAME</A></STRONG><BR>
<DD>
Specify the header file.
<P></P>
<DT><STRONG><A NAME="item_%2Di%2C_%2D%2Dinterp%3D%27PROG_ARG_%2E%2E%2E%27">-i, --interp='PROG ARG ...'</A></STRONG><BR>
<DD>
Specify the interpreter with its arguments.
<P></P>
<DT><STRONG><A NAME="item_%2Dl%2C_%2D%2Dlanguage_LANG">-l, --language LANG</A></STRONG><BR>
<DD>
Specify the interpreter language to be used.
This option is valid
if the tool has been configured with
<CODE>--enable-polyglot</CODE> option.
<P></P>
<DT><STRONG><A NAME="item_%2Do%2C_%2D%2Doutput%3DFILENAME">-o, --output=FILENAME</A></STRONG><BR>
<DD>
Specify the output file.
<P></P>
<DT><STRONG><A NAME="item_%2D%2Dhelp">--help</A></STRONG><BR>
<DD>
Print a short help message.
<P></P>
<DT><STRONG><A NAME="item_%2D%2Dversion">--version</A></STRONG><BR>
<DD>
Print version information.
<P></P></DL>
<P>
<H2><A NAME="scheme variables">SCHEME VARIABLES</A></H2>
<DL>
<DT><STRONG><A NAME="item_escm%2Dinput%2Dfile">&#42;escm-input-file&#42;</A></STRONG><BR>
<DD>
The name of the file which the tool is currently processing.
The value is false if the input is stdin.
<P></P>
<DT><STRONG><A NAME="item_escm%2Doutput%2Dfile">&#42;escm-output-file&#42;</A></STRONG><BR>
<DD>
The name of the output file.
It is false if the output is stdout.
<P></P>
<DT><STRONG><A NAME="item_escm%2Dinterpreter">&#42;escm-interpreter&#42;</A></STRONG><BR>
<DD>
The Scheme interpreter and its arguments.
<P></P>
<DT><STRONG><A NAME="item_escm%2Dversion">&#42;escm-version&#42;</A></STRONG><BR>
<DD>
The name and the version of this project.
<P></P>
<DT><STRONG><A NAME="item_escm%2Dquery%2Dstring">&#42;escm-query-string&#42;</A></STRONG><BR>
<DD>
The query string of a CGI program.
The request method is either <STRONG>POST</STRONG> or <STRONG>GET</STRONG>.
<P></P></DL>
<P>
<H2><A NAME="environment variables">ENVIRONMENT VARIABLES</A></H2>
<DL>
<DT><STRONG><A NAME="item_GATEWAY_INTERFACE">GATEWAY_INTERFACE</A></STRONG><BR>
<DD>
This variable is used to check whether
the tool is invoked in a CGI or not.
<P></P>
<DT><STRONG><A NAME="item_PATH_TRANSLATED">PATH_TRANSLATED</A></STRONG><BR>
<DD>
The file to be processed
when the tool is invoked as a handler CGI program.
<P></P>
<DT><STRONG><A NAME="item_ESCM_DEFAULT">ESCM_DEFAULT</A></STRONG><BR>
<DD>
The default interpreter language.
<P></P>
<DT><STRONG><A NAME="item_ESCM_BACKEND">ESCM_BACKEND</A></STRONG><BR>
<DD>
The default backend interpreter.
<P></P></DL>
<P>
<H2><A NAME="handler cgi program">HANDLER CGI PROGRAM</A></H2>
<P>You can use this tool as a handler CGI program,
if your web administrator allows you to override <STRONG>FileInfo</STRONG> directives.</P>
<P>Copy or hard-link <STRONG>aescm</STRONG> to
<CODE>~/public_html/cgi-bin/aescm.cgi</CODE>.
Then add these lines to your <CODE>.htaccess</CODE>.</P>
<PRE>
  AddHandler escm-handler escm
  Action escm-handler /~YOURNAME/cgi-bin/aescm.cgi</PRE>
<P>Access to a file suffixed with <CODE>.escm</CODE> will be processed by this tool
and embedded Scheme code will be evaluated.</P>
<P>
<H2><A NAME="other interpreter languages">OTHER INTERPRETER LANGUAGES</A></H2>
<P><STRONG>Aescm</STRONG>
is designed to be interpreter independent.
This does not mean Scheme interpreter independent.
You can also embed code of most interpreter languages,
e.g. Awk, Csh, Common Lisp, Perl, Python, Ruby, Sh, Tcl.
But you can use this feature
only when you have run <CODE>configure</CODE> script with <CODE>--enable-polyglot</CODE> option.</P>
<P>This short example for Awk
will show you a list of the environment variables.</P>
<PRE>
  #!/usr/local/bin/aescm \
    -l awk
  &lt;html&gt;&lt;head&gt;&lt;title&gt;Environment Variables&lt;/title&gt;&lt;/head&gt;
  &lt;body&gt;
  &lt;ul&gt;
  &lt;?awk
    for (key in ENVIRON) {
      print &quot;&lt;li&gt;&quot;, key, &quot;=&gt;&quot;, ENVIRON[key], &quot;&lt;/li&gt;&quot;
    }
  ?&gt;
  &lt;/ul&gt;
  &lt;/body&gt;&lt;/html&gt;</PRE>
<P>
<HR>
<H1><A NAME="caveats">CAVEATS</A></H1>
<UL>
<LI><STRONG><A NAME="item_B%3CAescm%3E_is_developers%27_version_of_B%3Cescm%"><STRONG>Aescm</STRONG>
is developers' version
of <STRONG>escm</STRONG>.
The stable version is still <STRONG>escm 1.1</STRONG>.</A></STRONG><BR>

<LI><STRONG><A NAME="item_B%3CAescm%3E_may_generate_a_very_long_string%2E_Ma"><STRONG>Aescm</STRONG>
may generate a very long string.
Make it sure that your interpreter might not have
buffer overflow bugs.</A></STRONG><BR>

<LI><STRONG><A NAME="item_A_document_written_in_a_multibyte_character_set_ma">A document written in a multibyte character set
may not be correctly processed
by an interpreter which may convert character sets.</A></STRONG><BR>

</UL>
<P>
<HR>
<H1><A NAME="changes">CHANGES</A></H1>
<P>In this section, I will describe differences from
the stable version.</P>
<P>
<H2><A NAME="syntax">Syntax</A></H2>
<P>The experimental version has adopted the XML syntax for a preprocessor
as <STRONG>eguile</STRONG> did
and eliminated the archaic one
with <CODE>&lt;?</CODE>, <CODE>&lt;?=</CODE> and <CODE>!&gt;</CODE>.</P>
<P>
<H2><A NAME="options">Options</A></H2>
<DL>
<DT><STRONG><A NAME="item_%2DH_Added%2E_Without_this_option%2C_a_content_hea">-H
Added.
Without this option, a content header for HTML will be automatically
written out in a CGI.</A></STRONG><BR>
<DD>
<DT><STRONG><A NAME="item_%2Df_Added%2E">-f
Added.</A></STRONG><BR>
<DD>
</DL>
<P>
<H2><A NAME="file arguments">File Arguments</A></H2>
<P>As many files as you specified are to be processed.
The stable version processes only the first one.</P>
<P>
<H2><A NAME="metaarguments">Meta-Arguments</A></H2>
<P>In place of <CODE>#?</CODE> prefix
has been adopted the meta-argument functionality
which was introduced by <STRONG>scsh</STRONG>.
But the syntax is different from that of <STRONG>scsh</STRONG>.</P>
<P>Ours works such as a shell without wildcard expansion,
so that arguments containing strings quoted either by <CODE>'</CODE> or
by <CODE></CODE> will be treated as we expected.</P>
<P>
<HR>
<H1><A NAME="author">AUTHOR</A></H1>
<PRE>
  Shiro Kawai  -- the original and stable escm
  TAGA Yoshitaka, tagga@tsuda.ac.jp</PRE>
<P>
<HR>
<H1><A NAME="see also">SEE ALSO</A></H1>
<P><STRONG>escm 1.1</STRONG> (<A HREF="http://www.shiro.dreamhost.com/scheme/vault/escm.html">http://www.shiro.dreamhost.com/scheme/vault/escm.html</A>),
<STRONG>eguile</STRONG> (<A HREF="http://woozle.org/~neale/src/eguile/">http://woozle.org/~neale/src/eguile/</A>),
<STRONG>brl</STRONG> (<A HREF="http://brl.sourceforge.net/">http://brl.sourceforge.net/</A>),
<STRONG>scsh</STRONG> (<A HREF="http://scsh.sourceforge.net/">http://scsh.sourceforge.net/</A>),
<STRONG>guile</STRONG>,
<STRONG>gosh</STRONG>,
<STRONG>2aescm</STRONG>.</P>
<hr />
<div>
<a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=68657&amp;type=1" width="88" height="31" border="0"" alt="SourceForge.net Logo" /></a>
</div>
</BODY>

</HTML>
