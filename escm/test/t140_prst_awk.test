# t140_prst_awk.test -*- sh -*-

. $srcdir/Init.sh

# Check the environment, and exit 77 if you skip this test.
if grep -e "undef  *ENABLE_POLYGLOT" ../src/config.h 1> /dev/null 2> /dev/null; then
    echo " -- Skipped" >> 00check.log
    exit 77
fi

# ${PROG} input 1> out 2> err
# where
#   input  -- the input file
#   out    -- stdout
#   out-ok -- expected stdout
#   err    -- stderr
#   err-ok -- expected stderr
# Files are compared by diff with $DIFF_OPTS options.
#
# Generate input, out-ok and err-ok.
# Then invoke the program as above.

cat <<EOF > input
<?awk:d escm_input_file?>
<?awk:d escm_output_file?>
EOF

cat <<EOF > out-ok
input
out
EOF

${PROG} -l ${srcdir}/../src/lang/awk input -o out 2> err

. $srcdir/Finish.sh

# end
